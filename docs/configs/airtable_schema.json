{
  "airtable_schema": {
    "version": "9.0",
    "description": "Schema otimizado do Airtable para BestStag v9.0 - Baseado nas valida√ß√µes das vers√µes Elaborando7",
    "created_date": "2025-06-03",
    "tables": {
      "Usuarios": {
        "description": "Tabela central de usu√°rios - Hub principal do sistema",
        "fields": {
          "id": {
            "type": "autonumber",
            "description": "ID √∫nico do usu√°rio",
            "primary_key": true
          },
          "nome": {
            "type": "single_line_text",
            "description": "Nome completo do usu√°rio",
            "required": true,
            "max_length": 100
          },
          "email": {
            "type": "email",
            "description": "Email principal do usu√°rio",
            "required": true,
            "unique": true
          },
          "telefone": {
            "type": "phone_number",
            "description": "N√∫mero do WhatsApp",
            "required": true,
            "format": "+55 11 99999-9999"
          },
          "status": {
            "type": "single_select",
            "description": "Status do usu√°rio",
            "options": ["ativo", "inativo", "suspenso", "trial"],
            "default": "trial"
          },
          "plano": {
            "type": "single_select",
            "description": "Plano de assinatura",
            "options": ["free", "pro", "enterprise"],
            "default": "free"
          },
          "data_criacao": {
            "type": "created_time",
            "description": "Data de cria√ß√£o do usu√°rio"
          },
          "ultimo_acesso": {
            "type": "last_modified_time",
            "description": "√öltimo acesso do usu√°rio"
          },
          "configuracoes": {
            "type": "long_text",
            "description": "Configura√ß√µes personalizadas em JSON",
            "format": "json"
          },
          "fuso_horario": {
            "type": "single_line_text",
            "description": "Fuso hor√°rio do usu√°rio",
            "default": "America/Sao_Paulo"
          },
          "idioma": {
            "type": "single_select",
            "description": "Idioma preferido",
            "options": ["pt-BR", "en-US", "es-ES"],
            "default": "pt-BR"
          },
          "total_tarefas": {
            "type": "count",
            "description": "Total de tarefas criadas",
            "linked_table": "Tarefas"
          },
          "total_eventos": {
            "type": "count",
            "description": "Total de eventos criados",
            "linked_table": "Eventos"
          },
          "total_interacoes": {
            "type": "count",
            "description": "Total de intera√ß√µes",
            "linked_table": "Interacoes"
          },
          "score_engajamento": {
            "type": "formula",
            "description": "Score de engajamento calculado",
            "formula": "({total_interacoes} * 0.3) + ({total_tarefas} * 0.4) + ({total_eventos} * 0.3)"
          },
          "data_ultimo_backup": {
            "type": "date",
            "description": "Data do √∫ltimo backup dos dados"
          }
        },
        "views": {
          "todos_usuarios": {
            "type": "grid",
            "description": "Visualiza√ß√£o de todos os usu√°rios"
          },
          "usuarios_ativos": {
            "type": "grid",
            "description": "Apenas usu√°rios ativos",
            "filter": "status = 'ativo'"
          },
          "usuarios_trial": {
            "type": "grid", 
            "description": "Usu√°rios em per√≠odo trial",
            "filter": "status = 'trial'"
          }
        }
      },
      "Emails": {
        "description": "Gest√£o e triagem de emails",
        "fields": {
          "id": {
            "type": "autonumber",
            "description": "ID √∫nico do email",
            "primary_key": true
          },
          "usuario": {
            "type": "link_to_another_record",
            "description": "Usu√°rio propriet√°rio",
            "linked_table": "Usuarios",
            "required": true
          },
          "remetente": {
            "type": "email",
            "description": "Email do remetente",
            "required": true
          },
          "assunto": {
            "type": "single_line_text",
            "description": "Assunto do email",
            "required": true,
            "max_length": 200
          },
          "data_recebimento": {
            "type": "date_time",
            "description": "Data e hora de recebimento",
            "required": true
          },
          "prioridade": {
            "type": "single_select",
            "description": "Prioridade do email",
            "options": ["baixa", "media", "alta", "urgente"],
            "default": "media"
          },
          "categoria": {
            "type": "single_select",
            "description": "Categoria do email",
            "options": ["trabalho", "pessoal", "promocional", "spam", "importante"]
          },
          "status": {
            "type": "single_select",
            "description": "Status de processamento",
            "options": ["nao_lido", "lido", "respondido", "arquivado"],
            "default": "nao_lido"
          },
          "resumo_ia": {
            "type": "long_text",
            "description": "Resumo gerado por IA"
          },
          "tags": {
            "type": "multiple_select",
            "description": "Tags para categoriza√ß√£o",
            "options": ["cliente", "fornecedor", "reuniao", "proposta", "contrato", "urgente"]
          },
          "acao_sugerida": {
            "type": "single_line_text",
            "description": "A√ß√£o sugerida pela IA"
          },
          "tempo_resposta": {
            "type": "formula",
            "description": "Tempo desde recebimento em horas",
            "formula": "DATETIME_DIFF(NOW(), {data_recebimento}, 'hours')"
          },
          "precisa_resposta": {
            "type": "checkbox",
            "description": "Email precisa de resposta"
          },
          "data_processamento": {
            "type": "date_time",
            "description": "Data de processamento pela IA"
          }
        },
        "views": {
          "emails_pendentes": {
            "type": "grid",
            "description": "Emails n√£o processados",
            "filter": "status = 'nao_lido'"
          },
          "alta_prioridade": {
            "type": "grid",
            "description": "Emails de alta prioridade",
            "filter": "prioridade = 'alta' OR prioridade = 'urgente'"
          },
          "precisa_resposta": {
            "type": "grid",
            "description": "Emails que precisam de resposta",
            "filter": "precisa_resposta = true"
          }
        }
      },
      "Eventos": {
        "description": "Gest√£o de calend√°rio e eventos",
        "fields": {
          "id": {
            "type": "autonumber",
            "description": "ID √∫nico do evento",
            "primary_key": true
          },
          "usuario": {
            "type": "link_to_another_record",
            "description": "Usu√°rio propriet√°rio",
            "linked_table": "Usuarios",
            "required": true
          },
          "titulo": {
            "type": "single_line_text",
            "description": "T√≠tulo do evento",
            "required": true,
            "max_length": 150
          },
          "descricao": {
            "type": "long_text",
            "description": "Descri√ß√£o detalhada do evento"
          },
          "data_inicio": {
            "type": "date_time",
            "description": "Data e hora de in√≠cio",
            "required": true
          },
          "data_fim": {
            "type": "date_time",
            "description": "Data e hora de fim",
            "required": true
          },
          "duracao_minutos": {
            "type": "formula",
            "description": "Dura√ß√£o em minutos",
            "formula": "DATETIME_DIFF({data_fim}, {data_inicio}, 'minutes')"
          },
          "tipo": {
            "type": "single_select",
            "description": "Tipo de evento",
            "options": ["reuniao", "tarefa", "compromisso", "lembrete", "bloqueio"],
            "default": "reuniao"
          },
          "status": {
            "type": "single_select",
            "description": "Status do evento",
            "options": ["agendado", "confirmado", "cancelado", "concluido"],
            "default": "agendado"
          },
          "local": {
            "type": "single_line_text",
            "description": "Local do evento"
          },
          "participantes": {
            "type": "long_text",
            "description": "Lista de participantes"
          },
          "link_reuniao": {
            "type": "url",
            "description": "Link para reuni√£o online"
          },
          "lembrete_minutos": {
            "type": "number",
            "description": "Lembrete em minutos antes",
            "default": 15
          },
          "recorrencia": {
            "type": "single_select",
            "description": "Padr√£o de recorr√™ncia",
            "options": ["nenhuma", "diaria", "semanal", "mensal", "anual"],
            "default": "nenhuma"
          },
          "google_event_id": {
            "type": "single_line_text",
            "description": "ID do evento no Google Calendar"
          },
          "criado_por": {
            "type": "single_select",
            "description": "Origem da cria√ß√£o",
            "options": ["whatsapp", "portal", "google_sync", "email"],
            "default": "whatsapp"
          },
          "data_criacao": {
            "type": "created_time",
            "description": "Data de cria√ß√£o"
          },
          "proximidade": {
            "type": "formula",
            "description": "Proximidade do evento",
            "formula": "IF(DATETIME_DIFF({data_inicio}, NOW(), 'hours') < 24, 'üî¥ Pr√≥ximo', IF(DATETIME_DIFF({data_inicio}, NOW(), 'hours') < 72, 'üü° Esta semana', 'üü¢ Futuro'))"
          }
        },
        "views": {
          "proximos_eventos": {
            "type": "calendar",
            "description": "Calend√°rio de pr√≥ximos eventos",
            "date_field": "data_inicio"
          },
          "hoje": {
            "type": "grid",
            "description": "Eventos de hoje",
            "filter": "IS_SAME({data_inicio}, TODAY(), 'day')"
          },
          "esta_semana": {
            "type": "grid",
            "description": "Eventos desta semana",
            "filter": "IS_SAME({data_inicio}, TODAY(), 'week')"
          }
        }
      },
      "Tarefas": {
        "description": "Gest√£o de tarefas e projetos",
        "fields": {
          "id": {
            "type": "autonumber",
            "description": "ID √∫nico da tarefa",
            "primary_key": true
          },
          "usuario": {
            "type": "link_to_another_record",
            "description": "Usu√°rio propriet√°rio",
            "linked_table": "Usuarios",
            "required": true
          },
          "titulo": {
            "type": "single_line_text",
            "description": "T√≠tulo da tarefa",
            "required": true,
            "max_length": 150
          },
          "descricao": {
            "type": "long_text",
            "description": "Descri√ß√£o detalhada da tarefa"
          },
          "status": {
            "type": "single_select",
            "description": "Status da tarefa",
            "options": ["pendente", "em_andamento", "concluida", "cancelada"],
            "default": "pendente"
          },
          "prioridade": {
            "type": "single_select",
            "description": "Prioridade da tarefa",
            "options": ["baixa", "media", "alta", "urgente"],
            "default": "media"
          },
          "categoria": {
            "type": "single_select",
            "description": "Categoria da tarefa",
            "options": ["trabalho", "pessoal", "estudo", "saude", "financeiro", "casa"]
          },
          "data_criacao": {
            "type": "created_time",
            "description": "Data de cria√ß√£o"
          },
          "data_vencimento": {
            "type": "date",
            "description": "Data de vencimento"
          },
          "data_conclusao": {
            "type": "date",
            "description": "Data de conclus√£o"
          },
          "estimativa_horas": {
            "type": "number",
            "description": "Estimativa de tempo em horas",
            "precision": 1
          },
          "tempo_gasto": {
            "type": "number",
            "description": "Tempo gasto em horas",
            "precision": 1
          },
          "progresso": {
            "type": "percent",
            "description": "Percentual de progresso",
            "default": 0
          },
          "tags": {
            "type": "multiple_select",
            "description": "Tags para organiza√ß√£o",
            "options": ["cliente", "projeto", "reuniao", "email", "ligacao", "documento"]
          },
          "evento_relacionado": {
            "type": "link_to_another_record",
            "description": "Evento relacionado",
            "linked_table": "Eventos"
          },
          "email_origem": {
            "type": "link_to_another_record",
            "description": "Email que originou a tarefa",
            "linked_table": "Emails"
          },
          "subtarefas": {
            "type": "long_text",
            "description": "Lista de subtarefas em JSON"
          },
          "anexos": {
            "type": "multiple_attachments",
            "description": "Arquivos anexos"
          },
          "dias_em_aberto": {
            "type": "formula",
            "description": "Dias desde cria√ß√£o",
            "formula": "DATETIME_DIFF(NOW(), {data_criacao}, 'days')"
          },
          "status_prazo": {
            "type": "formula",
            "description": "Status do prazo",
            "formula": "IF({data_vencimento}, IF({data_vencimento} < TODAY(), 'üî¥ Atrasada', IF(DATETIME_DIFF({data_vencimento}, TODAY(), 'days') <= 3, 'üü° Vence em breve', 'üü¢ No prazo')), '‚ö™ Sem prazo')"
          },
          "eficiencia": {
            "type": "formula",
            "description": "Efici√™ncia (estimado vs real)",
            "formula": "IF(AND({estimativa_horas}, {tempo_gasto}), ROUND(({estimativa_horas} / {tempo_gasto}) * 100, 0) & '%', '')"
          }
        },
        "views": {
          "tarefas_pendentes": {
            "type": "grid",
            "description": "Tarefas pendentes",
            "filter": "status != 'concluida' AND status != 'cancelada'"
          },
          "alta_prioridade": {
            "type": "grid",
            "description": "Tarefas de alta prioridade",
            "filter": "prioridade = 'alta' OR prioridade = 'urgente'"
          },
          "vencendo_hoje": {
            "type": "grid",
            "description": "Tarefas vencendo hoje",
            "filter": "IS_SAME({data_vencimento}, TODAY(), 'day')"
          },
          "kanban": {
            "type": "kanban",
            "description": "Visualiza√ß√£o Kanban",
            "group_by": "status"
          }
        }
      },
      "Interacoes": {
        "description": "Hist√≥rico de intera√ß√µes e mem√≥ria contextual",
        "fields": {
          "id": {
            "type": "autonumber",
            "description": "ID √∫nico da intera√ß√£o",
            "primary_key": true
          },
          "usuario": {
            "type": "link_to_another_record",
            "description": "Usu√°rio da intera√ß√£o",
            "linked_table": "Usuarios",
            "required": true
          },
          "tipo": {
            "type": "single_select",
            "description": "Tipo de intera√ß√£o",
            "options": ["whatsapp", "portal", "api", "webhook", "sistema"],
            "required": true
          },
          "canal": {
            "type": "single_select",
            "description": "Canal espec√≠fico",
            "options": ["whatsapp_message", "whatsapp_command", "portal_action", "api_call", "automation"]
          },
          "comando": {
            "type": "single_line_text",
            "description": "Comando executado"
          },
          "mensagem_usuario": {
            "type": "long_text",
            "description": "Mensagem enviada pelo usu√°rio"
          },
          "resposta_sistema": {
            "type": "long_text",
            "description": "Resposta do sistema"
          },
          "contexto": {
            "type": "long_text",
            "description": "Contexto da intera√ß√£o em JSON"
          },
          "data_hora": {
            "type": "created_time",
            "description": "Data e hora da intera√ß√£o"
          },
          "duracao_ms": {
            "type": "number",
            "description": "Dura√ß√£o do processamento em ms"
          },
          "status": {
            "type": "single_select",
            "description": "Status da intera√ß√£o",
            "options": ["sucesso", "erro", "timeout", "cancelada"],
            "default": "sucesso"
          },
          "erro_detalhes": {
            "type": "long_text",
            "description": "Detalhes do erro se houver"
          },
          "modelo_ia_usado": {
            "type": "single_select",
            "description": "Modelo de IA utilizado",
            "options": ["gpt-4", "gpt-3.5-turbo", "claude-3-sonnet", "claude-3-haiku"]
          },
          "tokens_consumidos": {
            "type": "number",
            "description": "Tokens consumidos na intera√ß√£o"
          },
          "custo_estimado": {
            "type": "currency",
            "description": "Custo estimado da intera√ß√£o",
            "precision": 4
          },
          "satisfacao": {
            "type": "rating",
            "description": "Satisfa√ß√£o do usu√°rio (1-5)",
            "max": 5
          },
          "feedback": {
            "type": "long_text",
            "description": "Feedback do usu√°rio"
          },
          "memoria_camada": {
            "type": "single_select",
            "description": "Camada de mem√≥ria",
            "options": ["MCP", "MMP", "MLP"],
            "default": "MCP"
          },
          "relevancia_score": {
            "type": "number",
            "description": "Score de relev√¢ncia (0-100)",
            "precision": 2
          },
          "tags_contexto": {
            "type": "multiple_select",
            "description": "Tags de contexto",
            "options": ["trabalho", "pessoal", "urgente", "rotina", "novo_aprendizado"]
          }
        },
        "views": {
          "interacoes_recentes": {
            "type": "grid",
            "description": "Intera√ß√µes das √∫ltimas 24h",
            "filter": "DATETIME_DIFF(NOW(), {data_hora}, 'hours') <= 24"
          },
          "erros": {
            "type": "grid",
            "description": "Intera√ß√µes com erro",
            "filter": "status = 'erro'"
          },
          "alta_relevancia": {
            "type": "grid",
            "description": "Intera√ß√µes de alta relev√¢ncia",
            "filter": "relevancia_score >= 80"
          }
        }
      },
      "Configuracoes": {
        "description": "Configura√ß√µes e automa√ß√µes personalizadas",
        "fields": {
          "id": {
            "type": "autonumber",
            "description": "ID √∫nico da configura√ß√£o",
            "primary_key": true
          },
          "usuario": {
            "type": "link_to_another_record",
            "description": "Usu√°rio propriet√°rio",
            "linked_table": "Usuarios",
            "required": true
          },
          "tipo": {
            "type": "single_select",
            "description": "Tipo de configura√ß√£o",
            "options": ["automacao", "preferencia", "integracao", "notificacao", "personaliza√ß√£o"],
            "required": true
          },
          "nome": {
            "type": "single_line_text",
            "description": "Nome da configura√ß√£o",
            "required": true
          },
          "descricao": {
            "type": "long_text",
            "description": "Descri√ß√£o da configura√ß√£o"
          },
          "ativa": {
            "type": "checkbox",
            "description": "Configura√ß√£o ativa",
            "default": true
          },
          "condicoes": {
            "type": "long_text",
            "description": "Condi√ß√µes em JSON"
          },
          "acoes": {
            "type": "long_text",
            "description": "A√ß√µes em JSON"
          },
          "frequencia": {
            "type": "single_select",
            "description": "Frequ√™ncia de execu√ß√£o",
            "options": ["manual", "tempo_real", "diaria", "semanal", "mensal"]
          },
          "data_criacao": {
            "type": "created_time",
            "description": "Data de cria√ß√£o"
          },
          "ultima_execucao": {
            "type": "date_time",
            "description": "√öltima execu√ß√£o"
          },
          "proxima_execucao": {
            "type": "date_time",
            "description": "Pr√≥xima execu√ß√£o"
          },
          "contador_execucoes": {
            "type": "number",
            "description": "N√∫mero de execu√ß√µes"
          },
          "taxa_sucesso": {
            "type": "percent",
            "description": "Taxa de sucesso das execu√ß√µes"
          },
          "configuracao_json": {
            "type": "long_text",
            "description": "Configura√ß√£o completa em JSON"
          },
          "tags": {
            "type": "multiple_select",
            "description": "Tags para organiza√ß√£o",
            "options": ["email", "calendario", "tarefas", "notificacoes", "relatorios"]
          },
          "prioridade": {
            "type": "single_select",
            "description": "Prioridade de execu√ß√£o",
            "options": ["baixa", "media", "alta"],
            "default": "media"
          }
        },
        "views": {
          "configuracoes_ativas": {
            "type": "grid",
            "description": "Configura√ß√µes ativas",
            "filter": "ativa = true"
          },
          "automacoes": {
            "type": "grid",
            "description": "Apenas automa√ß√µes",
            "filter": "tipo = 'automacao'"
          },
          "execucao_hoje": {
            "type": "grid",
            "description": "Execu√ß√µes programadas para hoje",
            "filter": "IS_SAME({proxima_execucao}, TODAY(), 'day')"
          }
        }
      }
    },
    "relationships": {
      "usuario_central": {
        "description": "Usu√°rio como hub central",
        "connections": [
          "Usuarios -> Emails (1:N)",
          "Usuarios -> Eventos (1:N)",
          "Usuarios -> Tarefas (1:N)",
          "Usuarios -> Interacoes (1:N)",
          "Usuarios -> Configuracoes (1:N)"
        ]
      },
      "cross_references": {
        "description": "Refer√™ncias cruzadas entre entidades",
        "connections": [
          "Emails -> Tarefas (1:N) - Email pode gerar m√∫ltiplas tarefas",
          "Eventos -> Tarefas (1:N) - Evento pode ter tarefas relacionadas",
          "Tarefas -> Eventos (1:1) - Tarefa pode virar evento"
        ]
      }
    },
    "indexes": {
      "performance": [
        "Usuarios.email",
        "Usuarios.telefone",
        "Emails.data_recebimento",
        "Eventos.data_inicio",
        "Tarefas.data_vencimento",
        "Interacoes.data_hora"
      ]
    },
    "automations": {
      "airtable_native": [
        "Email recebido -> Criar notifica√ß√£o",
        "Tarefa vencendo -> Enviar lembrete",
        "Evento pr√≥ximo -> Notificar usu√°rio",
        "Backup di√°rio -> Atualizar data_ultimo_backup"
      ]
    },
    "validation_rules": {
      "data_integrity": [
        "Email deve ser √∫nico por usu√°rio",
        "Telefone deve ser √∫nico globalmente",
        "Data fim evento deve ser maior que data in√≠cio",
        "Progresso tarefa deve estar entre 0 e 100%"
      ]
    },
    "performance_targets": {
      "query_time": "< 3 segundos",
      "concurrent_users": "500+",
      "data_retention": "3 meses m√≠nimo",
      "backup_frequency": "Di√°rio"
    }
  }
}

